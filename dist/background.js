console.log("🚀 Background service worker loaded!");chrome.action.onClicked.addListener(async t=>{try{if(!t.id||!t.url){console.warn("⚠️ Invalid tab or URL.");return}t.url.includes("https://www.youtube.com/")||t.url.includes("http://www.youtube.com/")?t.url.includes("youtube.com/watch")?(await chrome.scripting.executeScript({target:{tabId:t.id},files:["content/contentScript.js"]}),console.log("✅ Content script injected."),chrome.tabs.sendMessage(t.id,{type:"TOGGLE_FLOATING_BUTTON"})):await chrome.scripting.executeScript({target:{tabId:t.id},func:()=>{const e=document.createElement("div");e.style.position="fixed",e.style.top="20px",e.style.left="50%",e.style.transform="translateX(-50%)",e.style.padding="10px 20px",e.style.backgroundColor="#f44336",e.style.color="white",e.style.fontSize="16px",e.style.fontWeight="bold",e.style.borderRadius="5px",e.innerText="⚠️ This is not a YouTube video page!",document.body.appendChild(e),setTimeout(()=>{e.remove()},3e3)}}):await chrome.scripting.executeScript({target:{tabId:t.id},func:()=>{const e=document.createElement("div");e.style.position="fixed",e.style.top="20px",e.style.left="50%",e.style.transform="translateX(-50%)",e.style.padding="10px 20px",e.style.backgroundColor="#f44336",e.style.color="white",e.style.fontSize="16px",e.style.fontWeight="bold",e.style.borderRadius="5px",e.innerText="⚠️ This is not a YouTube video page!",document.body.appendChild(e),setTimeout(()=>{e.remove()},3e3)}})}catch(e){console.error("❌ Injection or Messaging error:",e)}});chrome.runtime.onMessage.addListener((t,e,r)=>{if(t.type==="FETCH_YOUTUBE_URL")return chrome.tabs.query({active:!0,currentWindow:!0},i=>{const o=i[0];o&&o.url&&o.url.includes("youtube.com/watch")?r({url:o.url}):r({url:null})}),!0});
